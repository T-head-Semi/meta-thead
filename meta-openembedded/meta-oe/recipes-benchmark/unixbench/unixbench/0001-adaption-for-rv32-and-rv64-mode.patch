From ed65d74013b58ed1ef4ffbd5e27dfcc364d7fc85 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?=E6=81=92=E7=95=85?= <dongkaiyuan.dky@alibaba-inc.com>
Date: Fri, 18 Oct 2024 13:53:37 +0000
Subject: [PATCH] adaption for rv32 and rv64 mode.

---
 UnixBench/Makefile | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/UnixBench/Makefile b/UnixBench/Makefile
index 4874d1f..dc2f951 100644
--- a/UnixBench/Makefile
+++ b/UnixBench/Makefile
@@ -55,7 +55,7 @@ GL_LIBS = -lGL -lXext -lX11
 # COMPILER CONFIGURATION: Set "CC" to the name of the compiler to use
 # to build the binary benchmarks.  You should also set "$cCompiler" in the
 # Run script to the name of the compiler you want to test.
-CC=gcc
+CC=riscv64-linux-gcc
 
 # OPTIMISATION SETTINGS:
 # Use gcc option if defined UB_GCC_OPTIONS via "Environment variable" or "Command-line arguments".
@@ -96,8 +96,10 @@ else
     #   - Not Supported: IBM Power, etc...
     ifeq ($(ARCH),$(filter $(ARCH),ppc64 ppc64le))
         OPTON += -mcpu=native -mtune=native
-    else ifeq ($(ARCH),riscv64)
-        OPTON += -march=rv64g -mabi=lp64d
+    else ifeq ($(TUNE_ARCH),riscv64)
+        OPTON += -march=rv64imafdc -mabi=lp64d
+    else ifeq ($(TUNE_ARCH),riscv32)
+        OPTON += -march=rv32imafdc -mabi=ilp32d
     else
         OPTON += -march=native -mtune=native
     endif
-- 
2.47.0

